<!doctype html>
<html lang="en">
<head>
    <title></title>
    <style>
        {% include('style.css.j2') %}
    </style>
</head>
<body>
    <p><b>Current time: {{ now.astimezone() }}</b></p>
    <main>
        {% for entry in entries %}
            <section id="entry{{ entry.id }}">
                <span class="entry-id">#{{ entry.id }}</span>
                <span class="entry-date">{{ entry.date }}</span>
                <button class="entry-button" onclick="del({{ entry.id }})">Delete</button>
                <span class="entry-price">{{ entry.price }}</span>

                <ul class="entry-products">
                    {% for pid, product in entry.products %}
                        <li>{{ product }} ({{ pid }})</li>
                    {% endfor %}
                </ul>
            </section>
        {% endfor %}
    </main>

    <script type="text/javascript">
        function del(idx) {
            fetch("/entry/" + idx, {method: "DELETE"}).then((res) => {
                if (res.ok) {
                    const section = document.getElementById("entry" + idx);
                    section.style.color = "lightgray";
                }
            });
        }
    </script>
</body>
</html>